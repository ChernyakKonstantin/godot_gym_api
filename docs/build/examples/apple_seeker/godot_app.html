<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Creating Godot Application &mdash; Godot Gym API 1.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=91e4a3f0"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Creating Gym Environment" href="gym_env.html" />
    <link rel="prev" title="Creating protobuf message" href="message_proto.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Godot Gym API
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../godot/index.html">Godot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python/index.html">Python</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Apple Seeker example</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="index.html#environment-description">Environment Description</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html#steps">Steps</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="project.html">Project Creating</a></li>
<li class="toctree-l4"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="message_proto.html">Creating protobuf message</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Creating Godot Application</a></li>
<li class="toctree-l4"><a class="reference internal" href="gym_env.html">Creating Gym Environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="agent_training.html">Training</a></li>
<li class="toctree-l4"><a class="reference internal" href="final.html">Final</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Godot Gym API</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Examples</a></li>
          <li class="breadcrumb-item"><a href="index.html">Apple Seeker example</a></li>
      <li class="breadcrumb-item active">Creating Godot Application</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/examples/apple_seeker/godot_app.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="creating-godot-application">
<h1>Creating Godot Application<a class="headerlink" href="#creating-godot-application" title="Permalink to this heading"></a></h1>
<p>In this step, we will create our 3D-environment in Godot.</p>
<p>Download predefined assets to create the environment from <a class="reference external" href="https://drive.google.com/drive/folders/11WHN71MlsSQczIingNdGwSnW6G2fU5sU?usp=drive_link">here</a>
and copy-paste the <code class="docutils literal notranslate"><span class="pre">assets</span></code> directory into your Godot project directory.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We exclude the process of the assets creating from the tutorial scope.</p>
</div>
<section id="creating-world">
<h2>Creating World<a class="headerlink" href="#creating-world" title="Permalink to this heading"></a></h2>
<p>Now we are going to create a <em>World</em>.
In <strong>Godot Gym API</strong> <em>World</em> (<code class="docutils literal notranslate"><span class="pre">RLEnvWorld</span></code> node) is assumed to be everything in the environment
the agent can interact with. For this tutotial, the <em>World</em> is a room with an apple inside.
The apple can be located anywhere inside the room and its location is assigned on the <em>World</em> reset.</p>
<ol class="arabic simple">
<li><p>Create a new scene with <code class="docutils literal notranslate"><span class="pre">World.tscn</span></code> name.</p></li>
<li><p>In scene tree click <em>Other node</em>.</p></li>
</ol>
<a class="reference internal image-reference" href="../../_images/add_root_node.png"><img alt="../../_images/add_root_node.png" src="../../_images/add_root_node.png" style="width: 200px;" /></a>
<ol class="arabic simple" start="2">
<li><p>Search for <code class="docutils literal notranslate"><span class="pre">RLEnvWorld</span></code> node and create it.</p></li>
</ol>
<a class="reference internal image-reference" href="../../_images/search_rl_env_node.png"><img alt="../../_images/search_rl_env_node.png" src="../../_images/search_rl_env_node.png" style="width: 600px;" /></a>
<ol class="arabic simple" start="3">
<li><p>Rename the node. In this tutorial, the node name is <em>World</em>.</p></li>
<li><p>Drag and drop <code class="docutils literal notranslate"><span class="pre">Room.tscn</span></code> and <code class="docutils literal notranslate"><span class="pre">Apple.tcsn</span></code> from <code class="docutils literal notranslate"><span class="pre">assets</span></code> directory to <em>World</em> node children.</p></li>
<li><p>Detach <em>World</em> node default script.</p></li>
</ol>
<a class="reference internal image-reference" href="../../_images/detach_rl_env_script.png"><img alt="../../_images/detach_rl_env_script.png" src="../../_images/detach_rl_env_script.png" style="width: 200px;" /></a>
<ol class="arabic simple" start="5">
<li><p>Add new script and save it with <code class="docutils literal notranslate"><span class="pre">World.gd</span></code> name.</p></li>
</ol>
<a class="reference internal image-reference" href="../../_images/attach_rl_env_script.png"><img alt="../../_images/attach_rl_env_script.png" src="../../_images/attach_rl_env_script.png" style="width: 200px;" /></a>
<a class="reference internal image-reference" href="../../_images/save_world_script.png"><img alt="../../_images/save_world_script.png" src="../../_images/save_world_script.png" style="width: 200px;" /></a>
<ol class="arabic simple" start="6">
<li><p>Define <em>World</em> node behaviour in the node script as follows:</p></li>
</ol>
<div class="highlight-gdscript notranslate"><div class="highlight"><pre><span></span><span class="k">extends</span><span class="w"> </span><span class="n">RLEnvWorld</span>

<span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">apple</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">Apple</span>
<span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">apple_caught</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>

<span class="k">func</span><span class="w"> </span><span class="n">_ready</span><span class="p">():</span>
<span class="w">    </span><span class="n">apple</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="s2">&quot;AppleCatchArea&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;body_entered&quot;</span><span class="p">,</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;_on_catch_apple&quot;</span><span class="p">)</span>

<span class="k">func</span><span class="w"> </span><span class="n">reset</span><span class="p">():</span>
<span class="w">    </span><span class="n">apple_caught</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
<span class="w">    </span><span class="n">apple</span><span class="o">.</span><span class="n">set_global_translation</span><span class="p">(</span><span class="n">sample_initial_position</span><span class="p">())</span>

<span class="k">func</span><span class="w"> </span><span class="n">sample_initial_position</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">Vector3</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># The method samples a random position within specified boundaries.</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">rand_range</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.55</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">rand_range</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb nb-Type">Vector3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span>

<span class="k">func</span><span class="w"> </span><span class="n">_on_catch_apple</span><span class="p">(</span><span class="n">_body</span><span class="p">):</span>
<span class="w">    </span><span class="n">apple_caught</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span>

<span class="c1"># The method does not depend on `observation_request` argument.</span>
<span class="k">func</span><span class="w"> </span><span class="n">get_data</span><span class="p">(</span><span class="n">observation_request</span><span class="p">,</span><span class="w"> </span><span class="n">storage</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
<span class="w">    </span><span class="n">storage</span><span class="o">.</span><span class="n">set_apple_caught</span><span class="p">(</span><span class="n">apple_caught</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s examine what is happening here.</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">RLEnvWorld.reset</span></code> method does nothing. Here, we override it
to reset <code class="docutils literal notranslate"><span class="pre">apple_caught</span></code> flag and place an apple randomly.</p>
<div class="highlight-gdscript notranslate"><div class="highlight"><pre><span></span><span class="k">func</span><span class="w"> </span><span class="n">reset</span><span class="p">():</span>
<span class="w">    </span><span class="n">apple_caught</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
<span class="w">    </span><span class="n">apple</span><span class="o">.</span><span class="n">set_global_translation</span><span class="p">(</span><span class="n">sample_initial_position</span><span class="p">())</span>
</pre></div>
</div>
<p>By default, <code class="docutils literal notranslate"><span class="pre">RLEnvWorld.get_data</span></code> method raise an error, since no data to return is specified.
Here, we override it to set <code class="docutils literal notranslate"><span class="pre">storage.apple_caught</span></code> field with <code class="docutils literal notranslate"><span class="pre">apple_caught</span></code> value.
<code class="docutils literal notranslate"><span class="pre">storage</span></code> is a field in protobuf message we have defined earlier.
In case you define various possible observations but you want to experiment with particular ones,
you can define logic of the storage filling with help of observation keys in <code class="docutils literal notranslate"><span class="pre">observation_request</span></code>.</p>
<div class="highlight-gdscript notranslate"><div class="highlight"><pre><span></span><span class="c1"># The method does not depend on `observation_request` argument.</span>
<span class="k">func</span><span class="w"> </span><span class="n">get_data</span><span class="p">(</span><span class="n">observation_request</span><span class="p">,</span><span class="w"> </span><span class="n">storage</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
<span class="w">    </span><span class="n">storage</span><span class="o">.</span><span class="n">set_apple_caught</span><span class="p">(</span><span class="n">apple_caught</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="creating-agent">
<h2>Creating Agent<a class="headerlink" href="#creating-agent" title="Permalink to this heading"></a></h2>
<p>Now we are going to create an <em>Agent</em>.
In <strong>Godot Gym API</strong> <em>Agent</em> (<code class="docutils literal notranslate"><span class="pre">RLAgent</span></code> node) is assumed stay in the same position,
while its children can move. This done to enable the agent control different node types
(e.g., <code class="docutils literal notranslate"><span class="pre">KinematicBody</span></code> or <code class="docutils literal notranslate"><span class="pre">VehcileBody</span></code>).</p>
<ol class="arabic simple">
<li><p>Create a new scene with <code class="docutils literal notranslate"><span class="pre">Agent.tscn</span></code> name.</p></li>
<li><p>Search for <code class="docutils literal notranslate"><span class="pre">RLAgent</span></code> node and create it.</p></li>
<li><p>Rename the node. In this tutorial, the node name is <em>Agent</em>.</p></li>
</ol>
<p>4. Add a <code class="docutils literal notranslate"><span class="pre">Spatial</span></code> node to <em>Agent</em> children and name it as <em>Sensors</em>.
Add 16 <code class="docutils literal notranslate"><span class="pre">RayCast</span></code> node to <em>Sensors</em> children and enable them in <strong>Inspector</strong> tab.
Locate the <cite>RayCast</cite> in circle as shown on image below.</p>
<p><strong>TODO: add picture</strong></p>
<ol class="arabic simple" start="5">
<li><p>Detach <em>Agent</em> default script and create the new one with <code class="docutils literal notranslate"><span class="pre">Agent.gd</span></code> name.</p></li>
</ol>
<div class="highlight-gdscript notranslate"><div class="highlight"><pre><span></span><span class="k">extends</span><span class="w"> </span><span class="n">RLAgent</span>

<span class="c1"># Define action values. Python will return `int` values, not `string` action names.</span>
<span class="k">const</span><span class="w"> </span><span class="n">MOVE_RIGHT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="k">const</span><span class="w"> </span><span class="n">MOVE_LEFT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="k">const</span><span class="w"> </span><span class="n">MOVE_UP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="k">const</span><span class="w"> </span><span class="n">MOVE_DOWN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>

<span class="k">export</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">target_node_path</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">NodePath</span>

<span class="k">var</span><span class="w"> </span><span class="n">target</span>

<span class="c1"># The maximum distance of the agent sensors.</span>
<span class="k">var</span><span class="w"> </span><span class="n">max_sensor_distance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>
<span class="c1"># How fast the agent moves in meters per second.</span>
<span class="k">var</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">14</span>
<span class="c1"># Current velocity of the agent.</span>
<span class="k">var</span><span class="w"> </span><span class="n">velocity</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">Vector3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">Vector3</span><span class="o">.</span><span class="n">ZERO</span>
<span class="c1"># Current action the agent performs.</span>
<span class="k">var</span><span class="w"> </span><span class="n">current_action</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>

<span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">Body</span>
<span class="k">onready</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">sensors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">Sensors</span>

<span class="k">func</span><span class="w"> </span><span class="n">_ready</span><span class="p">():</span>
<span class="w">    </span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_node</span><span class="p">(</span><span class="n">target_node_path</span><span class="p">)</span>
<span class="w">    </span><span class="nb">print</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<span class="w">    </span><span class="n">body</span><span class="o">.</span><span class="n">set_axis_lock</span><span class="p">(</span><span class="n">PhysicsServer</span><span class="o">.</span><span class="n">BODY_AXIS_LINEAR_Y</span><span class="p">,</span><span class="w"> </span><span class="bp">true</span><span class="p">)</span>

<span class="k">func</span><span class="w"> </span><span class="n">reset</span><span class="p">(</span><span class="n">new_position</span><span class="p">):</span>
<span class="w">    </span><span class="n">velocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">Vector3</span><span class="o">.</span><span class="n">ZERO</span>
<span class="w">    </span><span class="n">current_action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">    </span><span class="n">body</span><span class="o">.</span><span class="n">set_global_translation</span><span class="p">(</span><span class="n">new_position</span><span class="p">)</span>

<span class="c1"># The method does not depend on `observation_request` argument.</span>
<span class="k">func</span><span class="w"> </span><span class="n">get_data</span><span class="p">(</span><span class="n">observation_request</span><span class="p">,</span><span class="w"> </span><span class="n">storage</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">void</span><span class="p">:</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">distances_to_obstacle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">distances_to_target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">ray</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sensors</span><span class="o">.</span><span class="n">get_children</span><span class="p">():</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">distance</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max_sensor_distance</span>
<span class="w">        </span><span class="k">var</span><span class="w"> </span><span class="n">distance_to_target</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max_sensor_distance</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">ray</span><span class="o">.</span><span class="n">is_colliding</span><span class="p">():</span>
<span class="w">            </span><span class="n">distance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ray</span><span class="o">.</span><span class="n">global_translation</span><span class="o">.</span><span class="n">distance_to</span><span class="p">(</span><span class="n">ray</span><span class="o">.</span><span class="n">get_collision_point</span><span class="p">())</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">ray</span><span class="o">.</span><span class="n">get_collider</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">target</span><span class="p">:</span>
<span class="w">                </span><span class="n">distance_to_target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distance</span>
<span class="w">        </span><span class="n">storage</span><span class="o">.</span><span class="n">add_distances_to_obstacle</span><span class="p">(</span><span class="nb nb-Type">float</span><span class="p">(</span><span class="n">distance</span><span class="p">))</span>
<span class="w">        </span><span class="n">storage</span><span class="o">.</span><span class="n">add_distances_to_target</span><span class="p">(</span><span class="nb nb-Type">float</span><span class="p">(</span><span class="n">distance_to_target</span><span class="p">))</span>

<span class="k">func</span><span class="w"> </span><span class="n">set_action</span><span class="p">(</span><span class="n">action</span><span class="p">):</span>
<span class="w">    </span><span class="n">current_action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">action</span>

<span class="k">func</span><span class="w"> </span><span class="n">_physics_process</span><span class="p">(</span><span class="n">delta</span><span class="p">):</span>
<span class="w">    </span><span class="n">move_body</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>

<span class="c1"># The definition of `Body._physics_process` method to avoid extra scripts for sake of simplicity.</span>
<span class="k">func</span><span class="w"> </span><span class="n">move_body</span><span class="p">(</span><span class="n">delta</span><span class="p">):</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb nb-Type">Vector3</span><span class="o">.</span><span class="n">ZERO</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">current_action</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MOVE_RIGHT</span><span class="p">:</span>
<span class="w">        </span><span class="n">direction</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="n">current_action</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MOVE_LEFT</span><span class="p">:</span>
<span class="w">        </span><span class="n">direction</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="n">current_action</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MOVE_UP</span><span class="p">:</span>
<span class="w">        </span><span class="n">direction</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="n">current_action</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MOVE_DOWN</span><span class="p">:</span>
<span class="w">        </span><span class="n">direction</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">1</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb nb-Type">Vector3</span><span class="o">.</span><span class="n">ZERO</span><span class="p">:</span>
<span class="w">        </span><span class="n">direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">direction</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>
<span class="w">        </span><span class="n">body</span><span class="o">.</span><span class="n">look_at</span><span class="p">(</span><span class="n">body</span><span class="o">.</span><span class="n">translation</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">direction</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">Vector3</span><span class="o">.</span><span class="n">UP</span><span class="p">)</span>

<span class="w">    </span><span class="n">velocity</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">direction</span><span class="o">.</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">speed</span>
<span class="w">    </span><span class="n">velocity</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">direction</span><span class="o">.</span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">speed</span>
<span class="w">    </span><span class="n">velocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">body</span><span class="o">.</span><span class="n">move_and_slide</span><span class="p">(</span><span class="n">velocity</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">Vector3</span><span class="o">.</span><span class="n">UP</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="creating-environment">
<h2>Creating Environment<a class="headerlink" href="#creating-environment" title="Permalink to this heading"></a></h2>
<div class="highlight-gdscript notranslate"><div class="highlight"><pre><span></span><span class="k">extends</span><span class="w"> </span><span class="n">RLEnvironment</span>

<span class="k">func</span><span class="w"> </span><span class="n">_ready</span><span class="p">():</span>
<span class="w">    </span><span class="n">world</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">World</span>
<span class="w">    </span><span class="n">agent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="n">Agent</span>
<span class="w">    </span><span class="n">communication</span><span class="o">.</span><span class="n">start_server</span><span class="p">(</span><span class="mi">9090</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">)</span>

<span class="k">func</span><span class="w"> </span><span class="n">_reset</span><span class="p">():</span>
<span class="w">    </span><span class="n">world</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="w">    </span><span class="n">agent</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">world</span><span class="o">.</span><span class="n">sample_initial_position</span><span class="p">())</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="message_proto.html" class="btn btn-neutral float-left" title="Creating protobuf message" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gym_env.html" class="btn btn-neutral float-right" title="Creating Gym Environment" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, ChernyakKonstantin.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>